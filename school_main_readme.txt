This is the main as it was at the end of CECS 491B.